<div class="modal fade" id="addRoleModal">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal">
                    <span aria-hidden="true">&times;</span>
                    <span class="sr-only">Close</span>
                </button>
                <h4 class="modal-title">添加角色</h4>
            </div>
            <div class="modal-body">
                <div class="form-horizontal">
                    <div class="form-group">
                        <label for="name" class="col-sm-2 control-label">角色名称</label>
                        <div class="col-sm-10">
                            <input type="text" class="form-control" id="name" placeholder="请输入名称"/>
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="description" class="col-sm-2 control-label">描述</label>
                        <div class="col-sm-10">
                            <textarea class="form-control" id="description" rows="3"></textarea>
                        </div>
                    </div>

                    <hr>

                    <div class="form-group">
                        <label for="description" class="col-sm-2 control-label">权限</label>
                        <div class="col-sm-10">
                            <div id="treeview"></div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="modal-footer">
                <button type="button" class="btn btn-default" data-dismiss="modal">关闭</button>
                <button type="button" class="btn btn-primary" id="addNodeBtn">修改</button>
            </div>
        </div><!-- /.modal-content -->
    </div><!-- /.modal-dialog -->
</div><!-- /.modal -->


<script>
    $(function () {
        // 加载权限菜单
        $.get('${request.contextPath}/permissions', function (result) {
            var data = new Array();

            // 一级节点
            $.each(result, function (index, e) {
                if (e.parentId == null) {
                    data.push({id: e.id, text: e.name, path: e.path, icon: 'fa fa-home'});
                }
            });
            // 二级节点
            $.each(result, function (index, e) {
                if (e.parentId != null) {
                    for (var i in data) {
                        var parent = data[i];

                        if (parent.id == e.parentId) {
                            if (parent.nodes == null) {
                                parent.nodes = new Array();
                                // parent.selectable = false;
                            }
                            parent.nodes.push({id: e.id, text: e.name, icon: 'fa fa-file-code-o'});
                        }
                    }
                }
            });

            // 渲染权限树
            $('#treeview').treeview({
                levels: 1,
                expandIcon: 'fa fa-angle-left',
                collapseIcon: 'fa fa-angle-down',
                showBorder: false,
                //showTags: true,
                data: data
            });
        }, 'json');
    });
</script>